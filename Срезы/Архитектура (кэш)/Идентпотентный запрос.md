**Идемпотентность** — это свойство операции, при котором **повторное выполнение этой операции даёт тот же результат, что и первое выполнение**.  

То есть — **безопасно выполнять её сколько угодно раз**, и ничего "плохого" не случится.

# Пример из жизни

Представь, что у тебя есть кнопка «Выключить свет».  
Если свет уже выключен, и ты нажмёшь её ещё раз — ничего не изменится: свет останется выключенным.  
Эта кнопка — **идемпотентная**.

А теперь представь кнопку «Переключить свет» (вкл → выкл → вкл → выкл...).  
Каждое нажатие меняет состояние. Это — **не идемпотентная** операция.

# В контексте HTTP и Csharp#

| `GET`    | ✅ Да                                                          | Всегда возвращает одни и те же данные (если ресурс не менялся). Повторный запрос ничего не ломает.                                                                                                                                                                                                        |
| -------- | ------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `PUT`    | ✅ Да                                                          | Заменяет ресурс целиком. Если ты отправишь один и тот же`PUT`10 раз — ресурс будет в том же состоянии, что и после первого.                                                                                                                                                                               |
| `DELETE` | ✅ Да                                                          | Удалил — ресурс исчез. Повторное удаление (если сервер корректно реализован) не вызовет ошибки и не изменит состояние.                                                                                                                                                                                    |
| `POST`   | ❌ Нет                                                         | Обычно создаёт**новый**ресурс. Каждый повторный`POST`может создать дубликат (например, два заказа).                                                                                                                                                                                                       |
| `PATCH`  | ⚠️**Зависит от реализации**, но **должен быть идемпотентным** | Обновляет**часть**ресурса. Если патч применяет**абсолютные значения**(например,`"name": "Анна"`), то повторный запрос не изменит результат → идемпотентен. Но если патч содержит**относительные изменения**(например,`"balance += 100"`), то повторное применение изменит состояние →**не идемпотентен**. |
### Зачем это знать C# разработчику?

Если ты пишешь API на ASP.NET Core:

- При проектировании эндпоинтов **старайся делать операции идемпотентными**, где это возможно.
- Например, при обработке платежей или заказов — **добавь идемпотентный ключ** (например, `Idempotency-Key` в заголовке). Это позволяет клиенту безопасно повторять запрос, если не получил ответ (например, из-за таймаута), не боясь создать дубликат.