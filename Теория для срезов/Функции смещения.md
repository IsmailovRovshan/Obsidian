## Для чего нужны функции смещения

Они позволяют **“заглядывать” в соседние строки** (или крайние строки окна), не объединяя данные. Это полезно, когда надо:

1. **Сравнить текущую строку с предыдущей или следующей**  
    → например, рост/падение зарплаты или продаж.
2. **Посмотреть крайние значения**  
    → первая или последняя цена/зарплата/сделка в группе.
3. **Взять конкретное n-ое значение**  
    → например, в отделе вывести вторую по величине зарплату для всех сотрудников.

---

## Основные функции

- **`LAG(column, offset, default)`**  
    Возвращает значение из **предыдущей строки**.  
    Пример: зарплата предыдущего сотрудника.
- **`LEAD(column, offset, default)`**  
    Возвращает значение из **следующей строки**.  
    Пример: зарплата следующего сотрудника.
- **`FIRST_VALUE(column)`**  
    Возвращает **первое значение** в окне.  
    Пример: самая высокая зарплата в отделе.
- **`LAST_VALUE(column)`**  
    Возвращает **последнее значение** в окне (важно учитывать `ORDER BY`).
- **`NTH_VALUE(column, n)`**  
    Возвращает **n-ое значение** в окне.  
    Пример: показать вторую сделку по времени для всех строк.